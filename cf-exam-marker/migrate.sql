-- CF Exam Marker Database Migrations
-- Generated: 2026-01-16T11:16:48.312Z
-- This script applies all pending migrations in order

-- Migration 1: Fix Case Study Diagrams
-- Updates case_study_json to include visual_diagram, has_diagram, and context_plain

UPDATE questions SET case_study_json = '{"title":"Kite Festival","context_plain":"During a kite festival, a kite is flying at a height of 60m above the ground. The string attached to the kite is temporarily tied to a point on the ground. The inclination of the string with the ground is 60°. At the same time, another kite is flying such that its string makes an angle of 45° with the ground.","has_diagram":true,"visual_diagram":{"diagram_type":"geometric","svg_code":"<svg viewBox=''0 0 300 200'' xmlns=''http://www.w3.org/2000/svg''>\n  <!-- Sky Background -->\n  <rect width=''300'' height=''200'' fill=''#f0f8ff''/>\n  <!-- Ground -->\n  <rect y=''180'' width=''300'' height=''20'' fill=''#90ee90''/>\n  \n  <!-- Kite String -->\n  <line x1=''50'' y1=''180'' x2=''200'' y2=''50'' stroke=''#555'' stroke-width=''2'' stroke-dasharray=''5,5''/>\n  \n  <!-- Kite Body -->\n  <path d=''M200,50 L220,70 L200,100 L180,70 Z'' fill=''#ff6b6b'' stroke=''#c0392b'' stroke-width=''2''/>\n  <line x1=''180'' y1=''70'' x2=''220'' y2=''70'' stroke=''#c0392b''/>\n  <line x1=''200'' y1=''50'' x2=''200'' y2=''100'' stroke=''#c0392b''/>\n  \n  <!-- Measurements -->\n  <text x=''110'' y=''110'' font-family=''Arial'' font-size=''14'' fill=''#333''>Length L</text>\n  <text x=''240'' y=''80'' font-family=''Arial'' font-size=''14'' fill=''#333''>Height 60m</text>\n  \n  <!-- Height Line -->\n  <line x1=''200'' y1=''50'' x2=''200'' y2=''180'' stroke=''#333'' stroke-dasharray=''2,2''/>\n  \n  <!-- Angle -->\n  <path d=''M80,180 A30,30 0 0,0 75,158'' fill=''none'' stroke=''black''/>\n  <text x=''90'' y=''170'' font-size=''12''>60°</text>\n</svg>","description":"Two triangles representing kite strings"},"sub_questions":[{"part":"i","marks":1,"question":{"text_plain":"Find the length of the string of the first kite (assuming no slack)."},"answer":{"correct_answer_plain":"40√3 m"},"solution":{"steps":["Height h = 60.","Angle = 60°.","sin 60° = h/L","√3/2 = 60/L","L = 120/√3 = 40√3 m"]}},{"part":"ii","marks":1,"question":{"text_plain":"If the second kite is also at height 60m, find its string length."},"answer":{"correct_answer_plain":"60√2 m"},"solution":{"steps":["sin 45° = 60/L","1/√2 = 60/L","L = 60√2 m"]}},{"part":"iii","marks":2,"question":{"text_plain":"If the two kites are on opposite sides of the tying point, find the distance between the kites along the horizontal ground."},"answer":{"correct_answer_plain":"60(1 + 1/√3) m"},"solution":{"steps":["Base1 (tan 60) = 60/B1 => √3 = 60/B1 => B1 = 20√3.","Base2 (tan 45) = 60/B2 => 1 = 60/B2 => B2 = 60.","Total Dist = 60 + 20√3 = 20(3 + √3) m."]}}]}' WHERE id = 'cbse-10-math-full-01-U4-CS-Q36';
UPDATE questions SET case_study_json = '{"title":"Savings Scheme","context_plain":"Reena starts a savings scheme. She saves ₹100 in the first month, ₹120 in the second month, ₹140 in the third month, and so on. Her savings increase by a fixed amount every month.","has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_plain":"Find the amount she saves in the 10th month."},"answer":{"correct_answer_plain":"₹280"},"solution":{"steps":["a=100, d=20.","a10 = a+9d","100 + 9(20) = 280"]}},{"part":"ii","marks":1,"question":{"text_plain":"Find the total savings in 12 months."},"answer":{"correct_answer_plain":"₹2520"},"solution":{"steps":["S12 = 12/2 [2a + 11d]","6 [200 + 220]","6 [420] = 2520"]}},{"part":"iii","marks":2,"question":{"text_plain":"In which month will her monthly saving be ₹400?"},"answer":{"correct_answer_plain":"16th Month"},"solution":{"steps":["an = 400","a + (n-1)d = 400","100 + (n-1)20 = 400","(n-1)20 = 300","n-1 = 15","n = 16"]}}]}' WHERE id = 'cbse-10-math-full-01-U2-CS-Q37';
UPDATE questions SET case_study_json = '{"title":"Blood Donation Camp","context_plain":"In a blood donation camp, 50 donors participated. Their blood groups are recorded: 20 have Type A, 15 have Type B, 10 have Type O, and 5 have Type AB.","has_diagram":false,"visual_diagram":{"diagram_type":"geometric","svg_code":"<svg viewBox=''0 0 300 150'' xmlns=''http://www.w3.org/2000/svg''>\n  <rect width=''300'' height=''150'' fill=''#fff0f0''/>\n  \n  <!-- Drops -->\n  <path transform=''translate(50, 40) scale(2)'' d=''M10,0 C10,0 0,6 0,12 A10,10 0 1,0 20,12 C20,6 10,0 10,0'' fill=''#ff0000''/>\n  <text x=''60'' y=''100'' text-anchor=''middle'' font-weight=''bold''>Type A</text>\n  <text x=''60'' y=''120'' text-anchor=''middle''>20</text>\n  \n  <path transform=''translate(150, 40) scale(2)'' d=''M10,0 C10,0 0,6 0,12 A10,10 0 1,0 20,12 C20,6 10,0 10,0'' fill=''#cc0000''/>\n  <text x=''160'' y=''100'' text-anchor=''middle'' font-weight=''bold''>Type B</text>\n  <text x=''160'' y=''120'' text-anchor=''middle''>15</text>\n  \n  <path transform=''translate(250, 40) scale(2)'' d=''M10,0 C10,0 0,6 0,12 A10,10 0 1,0 20,12 C20,6 10,0 10,0'' fill=''#990000''/>\n  <text x=''260'' y=''100'' text-anchor=''middle'' font-weight=''bold''>Type O</text>\n  <text x=''260'' y=''120'' text-anchor=''middle''>10</text>\n</svg>","description":null},"sub_questions":[{"part":"i","marks":1,"question":{"text_plain":"Find the probability that a randomly selected donor has Type O blood."},"answer":{"correct_answer_plain":"1/5"},"solution":{"steps":["Total = 50. Type O = 10.","P(O) = 10/50 = 1/5"]}},{"part":"ii","marks":1,"question":{"text_plain":"Find the probability that a donor has Type A or Type B blood."},"answer":{"correct_answer_plain":"7/10"},"solution":{"steps":["Type A + Type B = 20 + 15 = 35.","P(A or B) = 35/50 = 7/10"]}},{"part":"iii","marks":2,"question":{"text_plain":"What is the probability that a donor does NOT have Type AB?"},"answer":{"correct_answer_plain":"9/10"},"solution":{"steps":["P(Not AB) = 1 - P(AB)","Type AB = 5.","P(AB) = 5/50 = 1/10.","1 - 1/10 = 9/10"]}}]}' WHERE id = 'cbse-10-math-full-01-U7-CS-Q38';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Find the distance of the first ship (angle $45^\\circ$) from the lighthouse."},"solution":{"steps_latex":["$\\tan 45 = 100/x \\Rightarrow x = 100\\text{ m}$."],"answer":{"correct_answer_plain":"100 m"}}},{"part":"ii","marks":1,"question":{"text_latex":"Find the distance of the second ship (angle $30^\\circ$) from the lighthouse."},"solution":{"steps_latex":["$\\tan 30 = 100/y \\Rightarrow 1/\\sqrt{3} = 100/y \\Rightarrow y = 100\\sqrt{3}\\text{ m}$."],"answer":{"correct_answer_plain":"100√3 m"}}},{"part":"iii","marks":2,"question":{"text_latex":"Find the distance between the two ships."},"solution":{"steps_latex":["$y - x = 100\\sqrt{3} - 100 = 100(\\sqrt{3}-1)\\text{ m}$."],"answer":{"correct_answer_plain":"100(√3-1) m"}}}]}' WHERE id = 'cbse-10-math-full-02-U4-CS-Q36-Unique';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Form a quadratic equation for width $x$."},"solution":{"steps_latex":["Length $= x+5$. Area $= x(x+5) = 100$.","$x^2 + 5x - 100 = 0$"]}},{"part":"ii","marks":1,"question":{"text_latex":"Find the discriminant."},"solution":{"steps_latex":["$D = 5^2 - 4(1)(-100) = 25 + 400 = 425$"]}},{"part":"iii","marks":2,"question":{"text_latex":"Find the dimensions."},"solution":{"steps_latex":["$x = \\frac{-5 \\pm \\sqrt{425}}{2} = \\frac{-5 \\pm 5\\sqrt{17}}{2}$","Take positive: $x \\approx 7.8\\text{ m}$"]}}]}' WHERE id = 'cbse-10-math-full-02-U2-CS-Q37';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Form an Arithmetic Progression (AP) from the given data."},"solution":{"steps_latex":["The sequence is $20, 22, 24, \\dots$","First term $a = 20$, common difference $d = 2$."]}},{"part":"ii","marks":1,"question":{"text_latex":"Find the number of seats in the $15^{\\text{th}}$ row."},"solution":{"steps_latex":["$a_{15} = a + 14d$","$= 20 + 14(2) = 20 + 28 = 48$ seats."]}},{"part":"iii","marks":2,"question":{"text_latex":"If there are 30 rows in total, find the total number of seats."},"solution":{"steps_latex":["$S_{30} = \\frac{30}{2}[2a + 29d]$","$= 15[2(20) + 29(2)] = 15[40 + 58]$","$= 15 \\times 98 = 1470$ seats."]}}]}' WHERE id = 'cbse-10-math-full-02-U2-Gap-CS11';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Volume of conical part."},"solution":{"steps_latex":["$\\frac{1}{3} \\pi (6^2)(12) = 144\\pi$"]}},{"part":"ii","marks":1,"question":{"text_latex":"Volume of hemispherical part."},"solution":{"steps_latex":["$\\frac{2}{3} \\pi (6^3) = 144\\pi$"]}},{"part":"iii","marks":2,"question":{"text_latex":"Total Volume."},"solution":{"steps_latex":["$144\\pi + 144\\pi = 288\\pi \\approx 904.32$"]}}]}' WHERE id = 'cbse-10-math-full-03-U6-S3-CS1';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Distance between Library and Park."},"solution":{"steps_latex":["$\\sqrt{(4-0)^2 + (0-3)^2} = 5$"]}},{"part":"ii","marks":1,"question":{"text_latex":"Distance between School and Park."},"solution":{"steps_latex":["3 units"]}},{"part":"iii","marks":2,"question":{"text_latex":"If a House is at the midpoint of Library and Park, find its coordinates."},"solution":{"steps_latex":["$(\\frac{4+0}{2}, \\frac{0+3}{2}) = (2, 1.5)$"]}}]}' WHERE id = 'cbse-10-math-full-03-S3-Fill-CS2';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Find the zeroes."},"solution":{"steps_latex":["$(x-6)(x-2)=0 \\Rightarrow 2, 6$"]}},{"part":"ii","marks":1,"question":{"text_latex":"At $x=0$, what is the height?"},"solution":{"steps_latex":["$0 - 0 + 12 = 12$"]}},{"part":"iii","marks":2,"question":{"text_latex":"Find the minimum point (Vertex)."},"solution":{"steps_latex":["$x = -b/2a = 8/2 = 4$. $y = 16 - 32 + 12 = -4$. Point $(4, -4)$."]}}]}' WHERE id = 'cbse-10-math-full-03-S3-Fill-CS3';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Height of tower."},"solution":{"steps_latex":["$15 \\tan 60 = 15\\sqrt{3}$."]}},{"part":"ii","marks":1,"question":{"text_latex":"Distance from top to point."},"solution":{"steps_latex":["$15 / \\cos 60 = 30$."]}},{"part":"iii","marks":2,"question":{"text_latex":"Area of triangle formed."},"solution":{"steps_latex":["$0.5 \\times 15 \\times 15\\sqrt{3}$."]}}]}' WHERE id = 'cbse-10-math-full-04-S4-Fill-CS1';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Common difference."},"solution":{"steps_latex":["$8-5=3$."]}},{"part":"ii","marks":1,"question":{"text_latex":"Distance for 10th potato."},"solution":{"steps_latex":["$a_{10} = 5 + 9(3) = 32$."]}},{"part":"iii","marks":2,"question":{"text_latex":"Total distance run for 10 potatoes (there and back)."},"solution":{"steps_latex":["$2 \\times S_{10}$. $S_{10} = 5(10 + 32)/2$."]}}]}' WHERE id = 'cbse-10-math-full-04-S4-Fill-CS2';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Distance AB."},"solution":{"steps_latex":["3 units."]}},{"part":"ii","marks":1,"question":{"text_latex":"Shape formed."},"solution":{"steps_latex":["Square."]}},{"part":"iii","marks":2,"question":{"text_latex":"Diagonal AC."},"solution":{"steps_latex":["$\\sqrt{3^2+3^2} = 3\\sqrt{2}$."]}}]}' WHERE id = 'cbse-10-math-full-04-S4-Fill-CS3';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Graph shape."},"solution":{"steps_latex":["Parabola downwards."]}},{"part":"ii","marks":1,"question":{"text_latex":"Find zeroes."},"solution":{"steps_latex":["$x^2-4x+3=0 \\Rightarrow (x-3)(x-1) \\Rightarrow 1, 3$."]}},{"part":"iii","marks":2,"question":{"text_latex":"Find vertex."},"solution":{"steps_latex":["$x=2, y=1$. Point $(2, 1)$."]}}]}' WHERE id = 'cbse-10-math-full-05-U2-S5-CS36';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Ratio of height to shadow."},"solution":{"steps_latex":["$1.8/0.6 = 3:1$."]}},{"part":"ii","marks":1,"question":{"text_latex":"Height of pole."},"solution":{"steps_latex":["$h/2.4 = 3 \\Rightarrow h = 7.2\\text{ m}$."]}},{"part":"iii","marks":2,"question":{"text_latex":"Is it AA similarity?"},"solution":{"steps_latex":["Yes, vertical angles and sun elevation."]}}]}' WHERE id = 'cbse-10-math-full-05-U4-S5-CS37';
UPDATE questions SET case_study_json = '{"has_diagram":false,"visual_diagram":null,"sub_questions":[{"part":"i","marks":1,"question":{"text_latex":"Total number of possible outcomes."},"solution":{"steps_latex":["$6 \\times 6 = 36$."],"answer":{"correct_answer_plain":"36"}}},{"part":"ii","marks":1,"question":{"text_latex":"Probability of getting a sum of 8."},"solution":{"steps_latex":["Pairs: (2,6), (3,5), (4,4), (5,3), (6,2). Count = 5. P = 5/36."],"answer":{"correct_answer_plain":"5/36"}}},{"part":"iii","marks":2,"question":{"text_latex":"Probability that the product of the numbers is 12."},"solution":{"steps_latex":["Pairs: (2,6), (3,4), (4,3), (6,2). Count = 4. P = 4/36 = 1/9."],"answer":{"correct_answer_plain":"1/9"}}}]}' WHERE id = 'cbse-10-math-full-05-U7-S5-CS38-Unique';

