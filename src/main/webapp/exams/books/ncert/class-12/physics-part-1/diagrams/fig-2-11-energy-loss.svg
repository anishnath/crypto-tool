<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 420">
  <defs>
    <style>
      .label { font-family: sans-serif; font-size: 14px; fill: #1f2937; text-anchor: middle; font-weight: bold; }
      .wire { stroke: #374151; stroke-width: 2.5; fill: none; }
      .plate { stroke: #3b82f6; stroke-width: 3; }
      .batt-long { stroke: #dc2626; stroke-width: 3; }
      .batt-short { stroke: #dc2626; stroke-width: 5; }
      .dim-line { stroke: #6b7280; stroke-width: 1; }
      .stage-box { fill: none; stroke: #d1d5db; stroke-width: 1.5; stroke-dasharray: 6; rx: 8; }
      .result-box { fill: #fef2f2; stroke: #fca5a5; stroke-width: 1.5; rx: 8; }
      .connect-arrow { stroke: #6b7280; stroke-width: 2; marker-end: url(#arrow-gry); }
      .watermark { font-family: sans-serif; font-size: 20px; fill: rgba(0,0,0,0.1); font-weight: bold; text-anchor: end; }
    </style>
    <marker id="arrow-gry" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#6b7280" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="250" y="24" class="label" font-size="16">Charge Sharing — Energy Loss</text>

  <!-- ===== STAGE 1: Charged capacitor ===== -->
  <rect x="15" y="38" width="215" height="185" class="stage-box" />
  <text x="122" y="56" class="label" fill="#6b7280" font-size="12">Stage 1: Charged</text>

  <!-- Battery (left) -->
  <polyline points="50,80 50,120" class="wire" />
  <line x1="36" y1="120" x2="64" y2="120" class="batt-long" />
  <line x1="40" y1="135" x2="60" y2="135" class="batt-short" />
  <polyline points="50,135 50,180" class="wire" />
  <text x="28" y="132" class="label" fill="#dc2626" font-size="11" text-anchor="end">200 V</text>

  <!-- Wire: top and bottom -->
  <polyline points="50,80 170,80" class="wire" />
  <polyline points="50,180 170,180" class="wire" />

  <!-- Capacitor C1 -->
  <polyline points="170,80 170,115" class="wire" />
  <line x1="155" y1="115" x2="185" y2="115" class="plate" />
  <line x1="155" y1="140" x2="185" y2="140" class="plate" />
  <polyline points="170,140 170,180" class="wire" />
  <text x="170" y="108" class="label" fill="#3b82f6" font-size="11">+Q</text>
  <text x="170" y="158" class="label" fill="#3b82f6" font-size="11">−Q</text>
  <text x="200" y="132" class="label" fill="#3b82f6" font-size="12" text-anchor="start">C₁</text>

  <!-- C1 value -->
  <text x="122" y="205" class="label" fill="#374151" font-size="11">C₁ = 600 pF, V = 200 V</text>

  <!-- Disconnect symbol (X on battery wire) -->
  <line x1="42" y1="90" x2="58" y2="76" stroke="#dc2626" stroke-width="2" />
  <line x1="42" y1="76" x2="58" y2="90" stroke="#dc2626" stroke-width="2" />
  <text x="50" y="72" class="label" fill="#dc2626" font-size="9">disconnect</text>

  <!-- Arrow between stages -->
  <line x1="238" y1="140" x2="268" y2="140" class="connect-arrow" />

  <!-- ===== STAGE 2: Connected in parallel ===== -->
  <rect x="272" y="38" width="215" height="185" class="stage-box" />
  <text x="380" y="56" class="label" fill="#6b7280" font-size="12">Stage 2: Sharing</text>

  <!-- Top wire -->
  <polyline points="310,80 450,80" class="wire" />
  <!-- Bottom wire -->
  <polyline points="310,180 450,180" class="wire" />

  <!-- Capacitor C1 (left) -->
  <polyline points="330,80 330,115" class="wire" />
  <line x1="315" y1="115" x2="345" y2="115" class="plate" />
  <line x1="315" y1="140" x2="345" y2="140" class="plate" />
  <polyline points="330,140 330,180" class="wire" />
  <text x="330" y="108" class="label" fill="#3b82f6" font-size="10">+Q/2</text>
  <text x="330" y="158" class="label" fill="#3b82f6" font-size="10">−Q/2</text>
  <text x="330" y="196" class="label" fill="#3b82f6" font-size="11">C₁</text>

  <!-- Capacitor C2 (right) -->
  <polyline points="430,80 430,115" class="wire" />
  <line x1="415" y1="115" x2="445" y2="115" class="plate" />
  <line x1="415" y1="140" x2="445" y2="140" class="plate" />
  <polyline points="430,140 430,180" class="wire" />
  <text x="430" y="108" class="label" fill="#3b82f6" font-size="10">+Q/2</text>
  <text x="430" y="158" class="label" fill="#3b82f6" font-size="10">−Q/2</text>
  <text x="430" y="196" class="label" fill="#3b82f6" font-size="11">C₂</text>

  <!-- Parallel symbol -->
  <text x="380" y="135" class="label" fill="#6b7280" font-size="12">∥</text>

  <!-- New voltage -->
  <text x="380" y="210" class="label" fill="#374151" font-size="11">V' = 100 V each</text>

  <!-- ===== Result Box ===== -->
  <rect x="70" y="240" width="360" height="155" class="result-box" />

  <!-- Energy calculations -->
  <text x="250" y="265" class="label" fill="#b91c1c" font-size="13">Energy Accounting</text>

  <text x="250" y="290" class="label" font-size="12" fill="#374151" font-weight="normal">
    U_initial = ½ × 600 × 10⁻¹² × (200)² = 1.2 × 10⁻⁵ J
  </text>
  <text x="250" y="312" class="label" font-size="12" fill="#374151" font-weight="normal">
    U_final  = ½ × 1200 × 10⁻¹² × (100)² = 6 × 10⁻⁶ J
  </text>

  <!-- Divider line -->
  <line x1="120" y1="322" x2="380" y2="322" stroke="#fca5a5" stroke-width="1" />

  <text x="250" y="345" class="label" font-size="14" fill="#dc2626">
    Energy lost = 6 × 10⁻⁶ J
  </text>
  <text x="250" y="370" class="label" font-size="12" fill="#6b7280" font-weight="normal">
    (50% lost as heat during charge redistribution)
  </text>
  <text x="250" y="388" class="label" font-size="11" fill="#6b7280" font-weight="normal">
    ΔU = ½ C₁C₂/(C₁+C₂) × (V₁−V₂)²
  </text>

  <!-- Watermark -->
  <text x="480" y="412" class="watermark">8gwifi.org</text>
</svg>
