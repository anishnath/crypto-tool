<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Temporary Email Online – Free Disposable Inbox | 8gwifi.org</title>
  <meta name="description" content="Free temporary email service. Generate disposable email addresses instantly, receive emails in real-time, no registration required. Auto-refresh inbox every 30 seconds. Perfect for testing and privacy.">
  <meta name="keywords" content="temporary email, temp email, disposable email, fake email, throwaway email, temp mail, disposable inbox, anonymous email, temp email generator, free temp email">
  <meta name="author" content="Anish Nath">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <link rel="canonical" href="https://8gwifi.org/temp-email.jsp">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Temporary Email Online – Free Disposable Inbox">
  <meta property="og:description" content="Free temporary email service. Generate disposable email addresses instantly, receive emails in real-time, no registration required.">
  <meta property="og:url" content="https://8gwifi.org/temp-email.jsp">
  <meta property="og:site_name" content="8gwifi.org">
  <meta property="og:image" content="https://8gwifi.org/images/site/logo.png">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Temporary Email Online – Free Disposable Inbox">
  <meta name="twitter:description" content="Free temporary email service. Generate disposable email addresses instantly, receive emails in real-time, no registration required.">
  <meta name="twitter:creator" content="@anish2good">
  <meta name="twitter:image" content="https://8gwifi.org/images/site/logo.png">
  <meta name="twitter:image" content="https://8gwifi.org/images/site/logo.png">

  <!-- JSON-LD structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Temporary Email Online – Free Disposable Inbox",
    "alternativeName": "Temp Mail Generator",
    "description": "Free temporary email service. Generate disposable email addresses instantly at goodbanners.xyz, receive emails in real-time with auto-refresh every 30 seconds. No registration required, perfect for testing, sign-ups, and privacy protection.",
    "url": "https://8gwifi.org/temp-email.jsp",
    "applicationCategory": "UtilityApplication",
    "applicationSubCategory": "Email Service",
    "operatingSystem": "Any (Web-based)",
    "browserRequirements": "Requires JavaScript. Works in Chrome, Firefox, Safari, Edge.",
    "datePublished": "2024-01-15",
    "dateModified": "2025-01-21",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "availability": "https://schema.org/InStock"
    },
    "featureList": [
      "Instant temporary email generation",
      "Disposable email addresses at @goodbanners.xyz domain",
      "Real-time email reception",
      "Auto-refresh inbox every 30 seconds",
      "View plain text and HTML email content",
      "No registration or sign-up required",
      "No password needed",
      "Copy email address to clipboard",
      "Custom email prefix selection",
      "Anonymous email service",
      "Privacy protection",
      "Perfect for testing and development",
      "Free forever with no limits",
      "Powered by procmail.xyz API"
    ],
    "author": {
      "@type": "Person",
      "name": "Anish Nath",
      "url": "https://8gwifi.org",
      "jobTitle": "Security Engineer & Developer",
      "sameAs": "https://twitter.com/anish2good",
      "knowsAbout": [
        "Email Services",
        "Privacy Tools",
        "Web Development",
        "Security Engineering",
        "Disposable Email Systems"
      ]
    },
    "provider": {
      "@type": "Organization",
      "name": "8gwifi.org",
      "url": "https://8gwifi.org",
      "logo": "https://8gwifi.org/images/logo.png",
      "description": "Free online security, cryptography, and utility tools for developers.",
      "founder": {
        "@type": "Person",
        "name": "Anish Nath"
      }
    }
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is a temporary email address?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "A temporary email address (also called disposable email or temp mail) is a short-term email address that you can use to receive emails without revealing your real email. It's perfect for sign-ups, testing, avoiding spam, and protecting your privacy. No registration or password required."
        }
      },
      {
        "@type": "Question",
        "name": "How long does the temporary email last?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The temporary email address remains active and can receive emails for the duration of your session. Emails are stored temporarily and can be accessed in real-time with auto-refresh every 30 seconds. For longer-term use, bookmark the page with your chosen email address."
        }
      },
      {
        "@type": "Question",
        "name": "Is this temporary email service free?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, completely free with no registration, no login, and no payment required. Generate unlimited disposable email addresses and receive emails without any restrictions or time limits."
        }
      },
      {
        "@type": "Question",
        "name": "Can I choose my own temp email address?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes! You can customize the local part (username) of your temporary email address. Just type any name you want before @goodbanners.xyz. The system will automatically generate one for you, but you can change it to anything you prefer."
        }
      },
      {
        "@type": "Question",
        "name": "How do I receive emails in my temp inbox?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "After generating your temporary email address, simply use it for sign-ups or testing. Emails sent to that address will appear automatically in the inbox below. The inbox refreshes every 30 seconds to show new messages in real-time. No manual refresh needed."
        }
      },
      {
        "@type": "Question",
        "name": "Is this temporary email anonymous and private?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, temporary email addresses provide privacy by not requiring personal information, registration, or verification. Use them to avoid spam and protect your real email address. However, remember that temp emails are not suitable for sensitive communications as they are accessible to anyone with the email address."
        }
      },
      {
        "@type": "Question",
        "name": "What can I use temporary email for?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Temporary emails are perfect for: testing email functionality, signing up for websites/services, avoiding spam, protecting your primary email, downloading files that require email verification, one-time registrations, and development/testing purposes. Not recommended for important accounts or sensitive data."
        }
      }
    ]
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "How to Use Temporary Email for Anonymous Sign-ups",
    "description": "Step-by-step guide to generate and use disposable email addresses online for free",
    "totalTime": "PT1M",
    "tool": {
      "@type": "HowToTool",
      "name": "Web browser"
    },
    "step": [
      {
        "@type": "HowToStep",
        "name": "Generate temp email address",
        "text": "A temporary email address is automatically generated when you load the page. You can customize the local part (username) by typing a different name in the input field before @goodbanners.xyz",
        "position": 1
      },
      {
        "@type": "HowToStep",
        "name": "Copy your temp email",
        "text": "Click the clipboard icon button to copy your temporary email address. Use this address for sign-ups, testing, or any service that requires email verification",
        "position": 2
      },
      {
        "@type": "HowToStep",
        "name": "Use the email for sign-ups",
        "text": "Use your temporary email address to sign up for websites, download files, or receive verification emails without exposing your real email address",
        "position": 3
      },
      {
        "@type": "HowToStep",
        "name": "Check your inbox",
        "text": "Incoming emails will appear automatically in the inbox below. The inbox refreshes every 30 seconds to show new messages in real-time. No manual refresh needed",
        "position": 4
      },
      {
        "@type": "HowToStep",
        "name": "Read your emails",
        "text": "Click on any email in the accordion to expand and read both plain text and HTML versions. View sender details, subject, and message content",
        "position": 5
      }
    ]
  }
  </script>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <%@ include file="header-script.jsp"%>
</head>
<%@ include file="body-script.jsp"%>
<div class="container py-4">
  <!-- Enhanced Header with Badges -->
  <h1 class="mb-2 text-center">Temporary Email Online – Free Disposable Inbox</h1>
  <p class="lead text-muted mb-3 text-center">Generate disposable email addresses instantly. No registration, auto-refresh inbox every 30 seconds, perfect for privacy and testing.</p>

  <!-- Feature Badges -->
  <div class="d-flex justify-content-center flex-wrap mb-4">
    <span class="badge badge-success badge-pill px-3 py-2 m-1"><i class="fas fa-envelope"></i> Instant Generation</span>
    <span class="badge badge-primary badge-pill px-3 py-2 m-1"><i class="fas fa-sync"></i> Auto-Refresh</span>
    <span class="badge badge-info badge-pill px-3 py-2 m-1"><i class="fas fa-user-secret"></i> Anonymous</span>
    <span class="badge badge-warning badge-pill px-3 py-2 m-1"><i class="fas fa-gift"></i> Free Forever</span>
  </div>

  <!-- Credit Banner -->
  <div class="alert alert-info border-info mb-3 text-center">
    <i class="fas fa-info-circle"></i> <strong>Powered by <a href="https://procmail.xyz" target="_blank" rel="noopener noreferrer" class="alert-link">procmail.xyz</a></strong> — A reliable temporary email API service providing instant disposable email addresses.
  </div>

  <!-- Trust Banner -->
  <div class="alert alert-light border shadow-sm mb-4">
    <div class="row text-center">
      <div class="col-md-3 col-6 mb-2">
        <i class="fas fa-lock text-primary fa-2x"></i>
        <p class="mb-0 mt-2"><strong>No Registration</strong></p>
        <small class="text-muted">Use instantly without signup</small>
      </div>
      <div class="col-md-3 col-6 mb-2">
        <i class="fas fa-bolt text-success fa-2x"></i>
        <p class="mb-0 mt-2"><strong>Real-Time Inbox</strong></p>
        <small class="text-muted">Auto-refresh every 30s</small>
      </div>
      <div class="col-md-3 col-6 mb-2">
        <i class="fas fa-shield-alt text-info fa-2x"></i>
        <p class="mb-0 mt-2"><strong>Privacy Protected</strong></p>
        <small class="text-muted">Anonymous email service</small>
      </div>
      <div class="col-md-3 col-6 mb-2">
        <i class="fas fa-infinity text-warning fa-2x"></i>
        <p class="mb-0 mt-2"><strong>Unlimited</strong></p>
        <small class="text-muted">Free with no limits</small>
      </div>
    </div>
  </div>

  <!-- Main Email Tool Section -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0"><i class="fas fa-envelope-open-text"></i> Your Temporary Email</h4>
    </div>
    <div class="card-body">
  <!-- Email input row -->
  <div class="row mb-3">
    <label for="local" class="col-sm-3 col-form-label fw-bold">Temp email address:</label>
    <div class="col-sm-9">
      <div class="input-group">
        <input type="text" class="form-control" id="local" placeholder="local-part" style="font-family: monospace; font-size: 14px;">
        <span class="input-group-text" id="domain" style="font-family: monospace; font-size: 14px;">@goodbanners.xyz</span>
        <button class="btn btn-success" type="button" id="copyBtn" title="Copy to clipboard">
          <i class="fas fa-copy"></i> Copy
        </button>
        <button class="btn btn-outline-primary" type="button" id="generateNewBtn" title="Generate new email">
          <i class="fas fa-sync-alt"></i> New
        </button>
      </div>
      <small class="d-block text-muted fst-italic">Note: choose any name – this becomes your temp email address.</small>
    </div>
  </div>
    </div>
  </div>

  <!-- Inbox section -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-success text-white d-flex align-items-center">
      <h4 class="mb-0"><i class="fas fa-inbox"></i> Inbox</h4>
      <div class="ms-auto">
        <button class="btn btn-light btn-sm me-2" type="button" id="manualRefreshBtn" title="Refresh inbox now">
          <i class="fas fa-sync-alt"></i> Refresh
        </button>
        <span class="text-white" id="countdown">Next auto-refresh: 30s</span>
      </div>
    </div>
    <div class="card-body">
  <div id="inbox" class="position-relative" style="min-height: 150px;">
    <!-- Spinner -->
    <div id="spinner" class="d-none position-absolute" style="top:10px; right:10px;">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <!-- Accordion messages -->
    <div id="accordionContainer" class="accordion"></div>
    <div id="emptyMsg" class="text-muted">Loading...</div>
  </div>
    </div>
  </div>

  <!-- E-E-A-T Sections Below -->

  <!-- How It Works -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-info text-white">
      <h4 class="mb-0"><i class="fas fa-cogs"></i> How It Works</h4>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-3 text-center mb-3">
          <div class="mb-2"><i class="fas fa-magic text-primary fa-3x"></i></div>
          <h5><span class="badge badge-primary">Step 1</span></h5>
          <p><strong>Auto-Generate Email</strong></p>
          <small class="text-muted">A random temporary email address is automatically generated when you visit this page using the procmail.xyz API.</small>
        </div>
        <div class="col-md-3 text-center mb-3">
          <div class="mb-2"><i class="fas fa-edit text-success fa-3x"></i></div>
          <h5><span class="badge badge-success">Step 2</span></h5>
          <p><strong>Customize (Optional)</strong></p>
          <small class="text-muted">You can customize the local part of the email address to anything you prefer, or click "New" to generate a fresh random address.</small>
        </div>
        <div class="col-md-3 text-center mb-3">
          <div class="mb-2"><i class="fas fa-paper-plane text-warning fa-3x"></i></div>
          <h5><span class="badge badge-warning">Step 3</span></h5>
          <p><strong>Use It Anywhere</strong></p>
          <small class="text-muted">Copy your temporary email and use it for sign-ups, downloads, testing, or any service that requires email verification.</small>
        </div>
        <div class="col-md-3 text-center mb-3">
          <div class="mb-2"><i class="fas fa-envelope-open text-info fa-3x"></i></div>
          <h5><span class="badge badge-info">Step 4</span></h5>
          <p><strong>Receive Instantly</strong></p>
          <small class="text-muted">Incoming emails appear automatically in your inbox below. The page auto-refreshes every 30 seconds to show new messages in real-time.</small>
        </div>
      </div>
    </div>
  </div>

  <!-- Common Use Cases -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-warning text-dark">
      <h4 class="mb-0"><i class="fas fa-lightbulb"></i> Common Use Cases</h4>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-4 mb-3">
          <h6 class="text-primary"><i class="fas fa-user-plus"></i> Website Sign-ups</h6>
          <p class="text-muted small">Register for websites or services without exposing your real email address. Perfect for one-time sign-ups or trial accounts.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="text-primary"><i class="fas fa-shield-alt"></i> Spam Prevention</h6>
          <p class="text-muted small">Avoid spam by using disposable email addresses for untrusted or promotional services. Keep your primary inbox clean.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="text-primary"><i class="fas fa-download"></i> File Downloads</h6>
          <p class="text-muted small">Download files that require email verification without revealing your personal email address.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="text-primary"><i class="fas fa-code"></i> Testing & Development</h6>
          <p class="text-muted small">Test email functionality in your applications during development without setting up real email accounts.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="text-primary"><i class="fas fa-user-secret"></i> Privacy Protection</h6>
          <p class="text-muted small">Maintain anonymity online by not sharing your real email address. Ideal for privacy-conscious users.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="text-primary"><i class="fas fa-check-circle"></i> Email Verification</h6>
          <p class="text-muted small">Receive verification emails instantly for account activations, password resets, or confirmation codes.</p>
        </div>
      </div>
      <div class="alert alert-warning mt-3">
        <i class="fas fa-exclamation-triangle"></i> <strong>Important:</strong> Do not use temporary emails for important accounts (banking, social media, work) or sensitive communications. These emails are not secure for long-term use.
      </div>
    </div>
  </div>

  <!-- About the Developer -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-secondary text-white">
      <h4 class="mb-0"><i class="fas fa-user"></i> About the Developer</h4>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-8">
          <h5>Anish Nath - Security Engineer & Developer</h5>
          <p class="text-muted">This temporary email service is built and maintained by <strong>Anish Nath</strong>, a security engineer and developer specializing in cryptography, privacy tools, and web development. With expertise in email systems and disposable email technologies, this tool is designed to provide a free, anonymous, and user-friendly temporary email service.</p>
          <p class="text-muted">Anish is the founder of <a href="https://8gwifi.org" target="_blank" rel="noopener">8gwifi.org</a>, a comprehensive platform offering free online security, cryptography, and utility tools for developers and security professionals worldwide.</p>
          <div class="mt-3">
            <a href="https://twitter.com/anish2good" target="_blank" rel="noopener" class="btn btn-outline-primary btn-sm">
              <i class="fab fa-twitter"></i> Follow on Twitter
            </a>
            <a href="https://8gwifi.org" target="_blank" rel="noopener" class="btn btn-outline-secondary btn-sm ml-2">
              <i class="fas fa-globe"></i> Visit 8gwifi.org
            </a>
          </div>
        </div>
        <div class="col-md-4 text-center">
          <i class="fas fa-user-circle text-muted" style="font-size: 120px;"></i>
          <p class="mt-2 text-muted"><strong>Anish Nath</strong></p>
          <p class="text-muted small">Security Engineer<br>Web Developer</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Why Trust This Tool -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0"><i class="fas fa-check-circle"></i> Why Trust This Tool</h4>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-4 mb-3">
          <div class="text-center mb-2"><i class="fas fa-lock text-success fa-3x"></i></div>
          <h5 class="text-center">No Data Collection</h5>
          <p class="text-muted small">We do not collect, store, or track any personal information. No cookies, no tracking, no registration required. Your privacy is our priority.</p>
        </div>
        <div class="col-md-4 mb-3">
          <div class="text-center mb-2"><i class="fas fa-code text-primary fa-3x"></i></div>
          <h5 class="text-center">Open & Transparent</h5>
          <p class="text-muted small">Built by a security engineer with expertise in email systems and privacy tools. The service is powered by procmail.xyz API, a reliable disposable email provider.</p>
        </div>
        <div class="col-md-4 mb-3">
          <div class="text-center mb-2"><i class="fas fa-users text-info fa-3x"></i></div>
          <h5 class="text-center">Community Trusted</h5>
          <p class="text-muted small">Part of the 8gwifi.org platform, trusted by developers and security professionals worldwide for free, high-quality online tools and utilities.</p>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Bootstrap 5 JS Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const FETCH_INTERVAL = 30;
  let countdown = FETCH_INTERVAL;
  let countdownInterval;
  const DOMAIN = '@goodbanners.xyz';

  // Fetch and set initial email
  async function generateEmail() {
    const res = await fetch('https://api.procmail.xyz/generate');
    const fullEmail = (await res.text()).trim();
    const localPart = fullEmail.split('@')[0];
    document.getElementById('local').value = localPart;
  }

  // Copy to clipboard
  function setupCopy() {
    const btn = document.getElementById('copyBtn');
    btn.addEventListener('click', () => {
      const local = document.getElementById('local').value.trim();
      const email = local + DOMAIN;
      navigator.clipboard.writeText(email).then(() => {
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
        btn.classList.remove('btn-success');
        btn.classList.add('btn-info');
        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.classList.remove('btn-info');
          btn.classList.add('btn-success');
        }, 2000);
      });
    });
  }

  // Generate new email
  function setupGenerateNew() {
    const btn = document.getElementById('generateNewBtn');
    btn.addEventListener('click', async () => {
      const originalHTML = btn.innerHTML;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
      btn.disabled = true;
      await generateEmail();
      btn.innerHTML = '<i class="fas fa-check"></i> Generated!';
      setTimeout(() => {
        btn.innerHTML = originalHTML;
        btn.disabled = false;
      }, 1500);
    });
  }

  // Manual refresh button
  function setupManualRefresh() {
    const btn = document.getElementById('manualRefreshBtn');
    btn.addEventListener('click', async () => {
      const originalHTML = btn.innerHTML;
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
      btn.disabled = true;
      await fetchInbox();
      btn.innerHTML = '<i class="fas fa-check"></i> Refreshed!';
      // Reset countdown
      startCountdown();
      setTimeout(() => {
        btn.innerHTML = originalHTML;
        btn.disabled = false;
      }, 1500);
    });
  }

  // Get the full email address
  function getEmail() {
    return document.getElementById('local').value.trim() + DOMAIN;
  }

  // Decode MIME encoded-word (RFC 2047) subject lines
  function decodeMIMEWord(str) {
    if (!str) return str;

    // Match MIME encoded-words: =?charset?encoding?encoded-text?=
    const mimeWordRegex = /=\?([^?]+)\?([BQbq])\?([^?]*)\?=/g;

    return str.replace(mimeWordRegex, (match, charset, encoding, encodedText) => {
      try {
        if (encoding.toUpperCase() === 'Q') {
          // Quoted-Printable decoding
          // Replace underscores with spaces (RFC 2047)
          let decoded = encodedText.replace(/_/g, ' ');
          // Decode =XX hex sequences
          decoded = decoded.replace(/=([0-9A-F]{2})/gi, (m, hex) => {
            return String.fromCharCode(parseInt(hex, 16));
          });
          // Try to decode as UTF-8
          try {
            return decodeURIComponent(escape(decoded));
          } catch (e) {
            return decoded;
          }
        } else if (encoding.toUpperCase() === 'B') {
          // Base64 decoding
          const decoded = atob(encodedText);
          try {
            return decodeURIComponent(escape(decoded));
          } catch (e) {
            return decoded;
          }
        }
      } catch (e) {
        console.error('Failed to decode MIME word:', e);
      }
      return match; // Return original if decoding fails
    });
  }

  // Render messages in Accordion
  function renderAccordion(messages) {
    const container = document.getElementById('accordionContainer');
    messages.sort((a, b) => new Date(b.ReceivedAt) - new Date(a.ReceivedAt));
    container.innerHTML = '';
    messages.forEach((msg, idx) => {
      const senderMatch = msg.Sender.match(/^(.*)<([^>]+)>/);
      const senderName = senderMatch ? senderMatch[1].trim() : msg.Sender;
      const senderEmail = senderMatch ? senderMatch[2].trim() : '';
      // Decode MIME encoded subject line
      const decodedSubject = decodeMIMEWord(msg.Subject);
      const headingId = 'heading' + idx;
      const collapseId = 'collapse' + idx;
      const isFirst = idx === 0;
      const btnClass = 'accordion-button' + (isFirst ? '' : ' collapsed');
      const collapseClass = 'accordion-collapse collapse' + (isFirst ? ' show' : '');
      const item = document.createElement('div');
      item.className = 'accordion-item';
      item.innerHTML =
              '<h2 class="accordion-header" id="' + headingId + '">' +
              '<button class="' + btnClass + '" type="button" data-bs-toggle="collapse" data-bs-target="#' + collapseId + '" aria-expanded="' + isFirst + '" aria-controls="' + collapseId + '">From: ' + senderName + ' (' + senderEmail + ') — Subject: ' + decodedSubject + '</button></h2>' +
              '<div id="' + collapseId + '" class="' + collapseClass + '" aria-labelledby="' + headingId + '" data-bs-parent="#accordionContainer">' +
              '<div class="accordion-body">' +
              '<p><strong>From:</strong> ' + senderName + ' &lt;' + senderEmail + '&gt;</p>' +
              '<p><strong>Subject:</strong> ' + decodedSubject + '</p>' +
              '<p><strong>Received At:</strong> ' + msg.ReceivedAt + '</p>' +
              '<p><strong>Plain Text:</strong><br><pre>' + msg.PlainTextBody + '</pre></p>' +
              '<p><strong>HTML:</strong><br><div>' + msg.HTMLBody + '</div></p>' +
              '</div></div>';
      container.appendChild(item);
    });
  }

  // Fetch inbox
  async function fetchInbox() {
    const email = getEmail();
    const spinner = document.getElementById('spinner');
    const emptyMsg = document.getElementById('emptyMsg');
    const container = document.getElementById('accordionContainer');
    spinner && spinner.classList.remove('d-none');
    try {
      const res = await fetch('https://api.procmail.xyz/inbox/' + email);
      const data = await res.json();
      if (!data || data.length === 0) {
        container.innerHTML = '';
        emptyMsg.textContent = 'No messages.';
      } else {
        emptyMsg.textContent = '';
        renderAccordion(data);
      }
    } catch (e) {
      container.innerHTML = '';
      emptyMsg.textContent = 'Error: ' + e.message;
    } finally {
      spinner && spinner.classList.add('d-none');
    }
  }

  // Countdown
  function startCountdown() {
    const countdownEl = document.getElementById('countdown');
    clearInterval(countdownInterval);
    countdown = FETCH_INTERVAL;
    countdownEl.textContent = 'Next auto-refresh: ' + countdown + 's';
    countdownInterval = setInterval(() => {
      countdown--;
      countdownEl.textContent = 'Next auto-refresh: ' + countdown + 's';
      if (countdown <= 0) clearInterval(countdownInterval);
    }, 1000);
  }

  // Schedule recurring fetches
  async function scheduleFetch() {
    startCountdown(); await fetchInbox();
    setTimeout(scheduleFetch, FETCH_INTERVAL * 1000);
  }

  // Init
  document.addEventListener('DOMContentLoaded', async () => {
    await generateEmail();
    setupCopy();
    setupGenerateNew();
    setupManualRefresh();
    document.getElementById('emptyMsg').textContent = 'Loading...';
    scheduleFetch();
  });
</script>
<%@ include file="thanks.jsp"%>

<hr>

<%@ include file="footer_adsense.jsp"%>


<%@ include file="addcomments.jsp"%>

</div>

<%@ include file="body-close.jsp"%>
