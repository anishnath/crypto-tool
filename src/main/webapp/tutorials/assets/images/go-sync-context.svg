<svg viewBox="0 0 900 650" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="900" height="650" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#2c3e50" text-anchor="middle">
    Sync Primitives &amp; Context in Go
  </text>
  
  <!-- Left Side: Sync Primitives -->
  <g>
    <rect x="30" y="60" width="420" height="540" rx="8" fill="#3498DB" opacity="0.05" stroke="#3498DB" stroke-width="2"/>
    <text x="240" y="90" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#3498DB" text-anchor="middle">
      Sync Primitives
    </text>
    
    <!-- WaitGroup -->
    <rect x="50" y="110" width="380" height="120" rx="6" fill="#E8F4F8" stroke="#3498DB" stroke-width="2"/>
    <text x="60" y="135" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      sync.WaitGroup
    </text>
    <text x="70" y="155" font-family="Courier New, monospace" font-size="12" fill="#555">
      var wg sync.WaitGroup
    </text>
    <text x="70" y="175" font-family="Courier New, monospace" font-size="12" fill="#555">
      wg.Add(1)    // Increment counter
    </text>
    <text x="70" y="195" font-family="Courier New, monospace" font-size="12" fill="#555">
      wg.Done()    // Decrement counter
    </text>
    <text x="70" y="215" font-family="Courier New, monospace" font-size="12" fill="#555">
      wg.Wait()    // Block until counter = 0
    </text>
    
    <!-- Mutex -->
    <rect x="50" y="245" width="380" height="120" rx="6" fill="#E8F5E9" stroke="#27AE60" stroke-width="2"/>
    <text x="60" y="270" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      sync.Mutex (Mutual Exclusion)
    </text>
    <text x="70" y="290" font-family="Courier New, monospace" font-size="12" fill="#555">
      var mu sync.Mutex
    </text>
    <text x="70" y="310" font-family="Courier New, monospace" font-size="12" fill="#555">
      mu.Lock()    // Acquire lock
    </text>
    <text x="70" y="330" font-family="Courier New, monospace" font-size="12" fill="#555">
      // Critical section
    </text>
    <text x="70" y="350" font-family="Courier New, monospace" font-size="12" fill="#555">
      mu.Unlock()  // Release lock
    </text>
    
    <!-- RWMutex -->
    <rect x="50" y="380" width="380" height="100" rx="6" fill="#F3E5F5" stroke="#9B59B6" stroke-width="2"/>
    <text x="60" y="405" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      sync.RWMutex (Read-Write Lock)
    </text>
    <text x="70" y="425" font-family="Courier New, monospace" font-size="12" fill="#555">
      mu.RLock()   // Multiple readers OK
    </text>
    <text x="70" y="445" font-family="Courier New, monospace" font-size="12" fill="#555">
      mu.RUnlock() // Release read lock
    </text>
    <text x="70" y="465" font-family="Courier New, monospace" font-size="12" fill="#555">
      mu.Lock()    // Exclusive write lock
    </text>
    
    <!-- Once -->
    <rect x="50" y="495" width="380" height="90" rx="6" fill="#FFF3E0" stroke="#E67E22" stroke-width="2"/>
    <text x="60" y="520" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      sync.Once (Run Once)
    </text>
    <text x="70" y="540" font-family="Courier New, monospace" font-size="12" fill="#555">
      var once sync.Once
    </text>
    <text x="70" y="560" font-family="Courier New, monospace" font-size="12" fill="#555">
      once.Do(func() { /* init */ })
    </text>
  </g>
  
  <!-- Right Side: Context -->
  <g>
    <rect x="470" y="60" width="400" height="540" rx="8" fill="#E67E22" opacity="0.05" stroke="#E67E22" stroke-width="2"/>
    <text x="670" y="90" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#E67E22" text-anchor="middle">
      Context Package
    </text>
    
    <!-- Context Types -->
    <rect x="490" y="110" width="360" height="140" rx="6" fill="#FFF3E0" stroke="#E67E22" stroke-width="2"/>
    <text x="500" y="135" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      Context Types
    </text>
    <text x="510" y="160" font-family="Courier New, monospace" font-size="12" fill="#555">
      context.Background()  // Root context
    </text>
    <text x="510" y="180" font-family="Courier New, monospace" font-size="12" fill="#555">
      context.TODO()        // Placeholder
    </text>
    <text x="510" y="200" font-family="Courier New, monospace" font-size="12" fill="#555">
      context.WithCancel(parent)
    </text>
    <text x="510" y="220" font-family="Courier New, monospace" font-size="12" fill="#555">
      context.WithTimeout(parent, duration)
    </text>
    <text x="510" y="240" font-family="Courier New, monospace" font-size="12" fill="#555">
      context.WithDeadline(parent, time)
    </text>
    
    <!-- Cancellation -->
    <rect x="490" y="265" width="360" height="110" rx="6" fill="#FFEBEE" stroke="#E74C3C" stroke-width="2"/>
    <text x="500" y="290" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      Cancellation Pattern
    </text>
    <text x="510" y="310" font-family="Courier New, monospace" font-size="11" fill="#555">
      ctx, cancel := context.WithCancel(parent)
    </text>
    <text x="510" y="330" font-family="Courier New, monospace" font-size="11" fill="#555">
      defer cancel()  // Always call cancel
    </text>
    <text x="510" y="350" font-family="Courier New, monospace" font-size="11" fill="#555">
      select {
    </text>
    <text x="510" y="365" font-family="Courier New, monospace" font-size="11" fill="#555">
        case &lt;-ctx.Done(): // Cancelled
    </text>
    
    <!-- Timeout -->
    <rect x="490" y="390" width="360" height="90" rx="6" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
    <text x="500" y="415" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      Timeout Pattern
    </text>
    <text x="510" y="435" font-family="Courier New, monospace" font-size="11" fill="#555">
      ctx, cancel := context.WithTimeout(
    </text>
    <text x="510" y="450" font-family="Courier New, monospace" font-size="11" fill="#555">
        parent, 5*time.Second)
    </text>
    <text x="510" y="465" font-family="Courier New, monospace" font-size="11" fill="#555">
      defer cancel()
    </text>
    
    <!-- Values -->
    <rect x="490" y="495" width="360" height="90" rx="6" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2"/>
    <text x="500" y="520" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      Context Values
    </text>
    <text x="510" y="540" font-family="Courier New, monospace" font-size="11" fill="#555">
      ctx = context.WithValue(ctx, key, val)
    </text>
    <text x="510" y="560" font-family="Courier New, monospace" font-size="11" fill="#555">
      value := ctx.Value(key)
    </text>
    <text x="510" y="575" font-family="Courier New, monospace" font-size="10" fill="#E74C3C">
      ⚠️ Use sparingly! Not for passing params
    </text>
  </g>
  
  <!-- Watermark -->
  <text x="880" y="640" font-family="Arial, sans-serif" font-size="12" fill="#95A5A6" text-anchor="end">
    8gwifi.org/tutorials/go
  </text>
</svg>
